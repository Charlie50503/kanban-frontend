<div
  class="bg-white rounded-lg p-4 shadow-sm border border-gray-200 group hover:shadow-md transition-shadow"
>
  <div class="flex items-start gap-3">
    <div
      class="flex-shrink-0 mt-1 text-gray-400 group-hover:text-gray-600 transition-colors"
    >
      <!-- 拖拽手柄圖示 -->
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-4 w-4"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        stroke-width="2"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M4 8h16M4 16h16"
        />
      </svg>
    </div>
    <div class="flex-1 min-w-0">
      <div class="flex justify-between items-center mb-2">
        <h4
          class="font-semibold text-gray-900 text-sm leading-tight flex-1 pr-2"
          [title]="task().title"
        >
          {{ task().title }}
        </h4>
        <div class="flex items-center gap-1.5 flex-shrink-0">
          <span
            class="px-1.5 py-0.5 rounded border text-xs font-medium"
            [ngClass]="getPriorityColor(task().priority!)"
            [title]="'優先級：' + task().priority"
          >
            {{ task().priority | priority }}
          </span>
          <button
            (click)="deleteTask(task().id!); $event.stopPropagation()"
            class="p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-full transition-colors opacity-0 group-hover:opacity-100"
          >
            <!-- 刪除圖示 -->
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-3.5 w-3.5"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
              />
            </svg>
          </button>
        </div>
      </div>
      <p
        class="text-gray-600 text-sm mb-3 line-clamp-2"
        *ngIf="task().description"
      >
        {{ task().description }}
      </p>
      <div class="mb-3" *ngIf="task().tags && task().tags!.length > 0">
        <div class="flex flex-wrap gap-1">
          <ng-container *ngFor="let tag of task().tags!.slice(0, 6)">
            <span
              class="bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full text-xs font-medium border border-blue-200"
            >
              {{ tag }}
            </span>
          </ng-container>
          <span
            *ngIf="task().tags!.length > 6"
            class="bg-gray-100 text-gray-500 px-2 py-0.5 rounded-full text-xs font-medium border border-gray-200"
          >
            +{{ task().tags!.length - 6 }} 更多
          </span>
        </div>
      </div>
      <div class="flex items-center justify-between text-xs">
        <div class="flex items-center gap-3">
          <span class="text-gray-500 flex items-center" *ngIf="task().assignee">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-3.5 w-3.5 mr-1"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
              />
            </svg>
            {{ task().assignee }}
          </span>
          <span class="text-gray-500 flex items-center" *ngIf="task().dueDate">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-3.5 w-3.5 mr-1"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
              />
            </svg>
            {{ task().dueDate | date: "yyyy/MM/dd" }}
          </span>
        </div>
        <div></div>
      </div>
    </div>
  </div>
</div>
